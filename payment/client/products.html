<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Membership Packages</title>
<!-- Bootstrap 5 CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
<!-- Custom Style for Dark Mode -->
<link rel="stylesheet" href="app.css">
</head>
<body style="background-color:inherit">

  <main>
    <div class="px-4 py-2 my-4 text-center">
      <img class="d-block mx-auto mb-4" src="http://localhost:5000/assets/images/chatflix-web-small.png" alt="" width="72" height="57">
      <h1 class="display-5 fw-bold text-body-emphasis">Activation Required</h1>
      <div class="col-lg-6 mx-auto">
        <p class="lead mb-4">Your free trial of Chatflix has expired, and you need to activate your device to continue.</p>
        <p>Please select the streaming package that best suits your needs, or use an activation code you already have...</p>
        <div class="d-grid gap-2 d-sm-flex justify-content-sm-center">
          <a class="see-packages btn btn-primary btn-lg px-4 gap-3">See Packages</a>
          <a class="use-code btn btn-outline-secondary btn-lg px-4">I Have A Code...</a>
        </div>
      </div>
    </div>


    <div class="top_part">
    <h3 id="packages-header">Chatflix Streaming Packages</h3>
    <p>All packages include <b>unlimited streaming</b> and <b>family sharing</b> on up to 10 devices.</p>
  </div>
    <div class="products-container">
  
    </div>
    <div class="container">
    <h3 id="enter-code-header">Activate Device</h3>
      <div class="input-group mb-3">
        <input id="activation-code" type="text" class="form-control" placeholder="Chatflix Activation Code" aria-label="Chatflix Activation Code" aria-describedby="activate-button">
        <button class="btn btn-outline-secondary" type="button" id="activate-button">Activate</button>
        <small>If you already purchased a membership package or a member has shared their code with you, please enter it here to add this device to your subscription</small>
      </div>
    </div>
        <small style="display: none;">Useful Information: Chatflix works anywhere in the world, and has no region restrictions. We have a massive library of movies and TV shows for you to watch. 75,000 movies, and 350,000 TV episodes on Server 1. We also offer subtitles in a wide variety of languages for the vast majority of content... click the "CC" button in the video player to enable captions. Finally, Chatflix streams are compatible with all common screen casting / mirroring protocols and devices. So you can stream from your phone to your TV with Airplay, Roku, Chromecast, etc</small>
  </main>

<!-- jQuery and Bootstrap Bundle JS -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
const CHATFLIX_APP_URL = location.href.indexOf('localhost') > 0 ? 'http://localhost:5000' : 'https://chatflix.org'
const getQueryParams = (name) => {
  const params = {};
  window.location.search.slice(1).split('&').forEach(param => {
    const [key, value] = param.split('=');
    params[key] = value;
  });
  if (name) return params[name]
  return params;
}
 const createLightweightResponsiveProductTable = (products) => {
   //generate the html for a lightweight, responsive, bootstrap table 
   //each row of the table contains duration, price, and max activations...
   //and of course a buy now linking to checkout.html?product_id=${product.id}

 }
$(document).ready(function() {
  $(".see-packages").click((e) => {
    e.preventDefault()
    $('html, body').animate({scrollTop: $("#packages-header").offset().top}, 250);
  });
  $(".use-code").click((e) => {
    e.preventDefault()
    $('html, body').animate({scrollTop: $("#enter-code-header").offset().top}, 250);
  });

  $("#activate-button").click((e) => {
    e.preventDefault();
    const code = $("#activation-code").val();
    window.location.href=`${CHATFLIX_APP_URL}/activate.html?code=${code}`
  })

  $.ajax({
    url: `${CHATFLIX_APP_URL}/api/membership/products`,
    type: 'GET',
    dataType: 'json',
    success: function(products) {

      products.filter(product => product.membership_duration > 1).forEach(function(product) {

        $('.products-container').append(`
          <div class="">
        <div class="card mb-4 rounded-3 shadow-sm border-primary">
          <div class="card-body">
            <h1 class="card-title pricing-card-title">${product.price} / ${product.membership_duration} days</h1>
            <ul class="list-unstyled mt-3 mb-4">
              <li>Unlimited VIP Streaming Package</li>
              <li>Family Sharing - Up to ${product.max_activations} devices</li>

            </ul>
            <a href="checkout.html?product_id=${product.id}" class="w-100 btn btn-lg btn-primary">Buy Now</a>
          </div>
        </div>
      </div>`
        );
      });



    } ,
    error: function(xhr, status, error) {
      $('#products-container').append('<p>Error loading products.</p>');
    }
  });
});
</script>

</body>
</html>
